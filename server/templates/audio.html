{% extends "layout.html" %}

{% block title %}This Audio Page{% endblock %}

{% block style %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/audio.css') }}">
{% endblock %}

{% block content %}
    <div class="container">
        <h2>ğŸµ Audio to Text Converter</h2>

        <div class="method-tabs">
            <button class="tab active" onclick="switchTab('live')">ğŸ¤ Live Recording</button>
            <button class="tab" onclick="switchTab('file')">ğŸ“ Audio File</button>
        </div>

        <!-- Live Recording Method -->
        <div id="live" class="method-content active">
            <div class="feature-info">
                <strong>Live Recording:</strong> Click "Start Recording" and speak directly into your microphone. The speech will be converted to text in real-time.
            </div>

            <div class="control-group">
                <label for="language">Language:</label>
                <select id="language" class="language-select">
                    <option value="en-US">English (US)</option>
                    <option value="en-GB">English (UK)</option>
                    <option value="es-ES">Spanish</option>
                    <option value="fr-FR">French</option>
                    <option value="de-DE">German</option>
                    <option value="it-IT">Italian</option>
                    <option value="pt-BR">Portuguese (BR)</option>
                    <option value="ru-RU">Russian</option>
                    <option value="zh-CN">Chinese (Simplified)</option>
                    <option value="ja-JP">Japanese</option>
                    <option value="ko-KR">Korean</option>
                </select>
            </div>

            <div class="controls">
                <button id="startBtn" class="btn btn-primary" onclick="startRecording()">
                    ğŸ¤ Start Recording
                </button>
                <button id="stopBtn" class="btn btn-danger" onclick="stopRecording()" disabled>
                    â¹ï¸ Stop Recording
                </button>
                <button class="btn btn-success" onclick="clearTranscript()">
                    ğŸ—‘ï¸ Clear
                </button>
            </div>

            <div id="liveStatus"></div>
        </div>

        <!-- File Upload Method -->
        <div id="file" class="method-content">
            <div class="feature-info">
                <strong>Audio File:</strong> Select an audio file from your computer. The browser will play it and convert the audio to text using speech recognition.
            </div>

            <input type="file" id="audioFile" accept="audio/*" class="file-input" onchange="handleFileSelect(event)">

            <audio id="audioPlayer" class="audio-player" controls style="display: none;"></audio>

            <div class="controls">
                <button id="transcribeBtn" class="btn btn-primary" onclick="transcribeAudioFile()" disabled>
                    ğŸ¯ Start Transcription
                </button>
                <button id="stopFileBtn" class="btn btn-danger" onclick="stopFileTranscription()" disabled>
                    â¹ï¸ Stop Transcription
                </button>
                <button class="btn btn-success" onclick="clearTranscript()">
                    ğŸ—‘ï¸ Clear
                </button>
            </div>

            <div id="fileStatus"></div>
        </div>

        <div style="margin-top: 20px;">
            <label for="transcript"><strong>Transcript:</strong></label>
            <div style="margin-top: 10px; display: flex; gap: 10px;">
                <button class="copy-btn" onclick="copyTranscript()">ğŸ“‹ Copy</button>
                <button class="copy-btn" onclick="downloadTranscript()">ğŸ’¾ Download</button>
            </div>
            <textarea id="transcript" class="transcript-area" placeholder="Your transcribed text will appear here..."></textarea>
        </div>
    </div>

    {% block scripts %}
      <script src="{{ url_for('static', filename='js/audio.js') }}"></script>
    {% endblock %}
{% endblock %}
